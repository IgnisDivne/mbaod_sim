$PROBLEM PK model
$INPUT ID TIME DV DROP DROP AMT DROP DROP DROP AGE WT
$DATA sim_data.csv IGNORE=@
$SUBROUTINES ADVAN1 TRANS2
$PK
 TVCL  = THETA(1) * EXP(ETA(1))
 TVV   = THETA(2)* EXP(ETA(2))
 TM50  = THETA(3)
 HILL   = THETA(4)

 CL    = TVCL *((WT/70)**0.75) *((AGE**HILL)/(AGE**HILL + TM50**HILL))
 V     = TVV *(WT/70)
 SC    = V

$THETA
 (0,  1  )        ; TVCL
 (0,  20  )       ; TVV
 (0,75)         ; TM50
 (1, 3)  ;HILL
$OMEGA
 0.05
 0.05

$SIGMA
 0.015
 0.0001 FIX

$ERROR
 IPRED = F
 Y= IPRED*(1+EPS(1))  + EPS(2)

$SIM (1000) ONLYSIM NSUBPROBLEM=1

$TABLE ID TIME DV AMT AGE WT FILE=mc_sim_1.tab NOAPPEND NOPRINT NOHEADER

;$EST METHOD=1 INTER MAXEVAL=9999 SIG=3 PRINT=5 NOABORT POSTHOC
