$PROBLEM PK model
$INPUT ID TIME DV DROP DROP AMT DROP DROP AGE WT
$DATA sim_data.csv IGNORE=@
$SUBROUTINES ADVAN1 TRANS2
$PK

 TVCL  = THETA(1) * EXP(ETA(1))
 TVV   = THETA(2) * EXP(ETA(2))
 TM50  = THETA(3)
 HL    = THETA(4)

 CL    = TVCL*(WT**0.75)*((1/70)**0.75)*((AGE**HL)/(AGE**HL + TM50**HL))
 V     = TVV *(WT/70)

 SC    = V
  
$THETA
 (0,  1,   100)        ; TVCL
 (0,  20,   100)       ; TVV
 (0, 56,  1000)         ; TM50
 (0, 3.1, 20)            ; HL

$OMEGA
 0.05
 0.05 

$SIGMA
 0.015
 0.0015

$ERROR
 IPRED = F
 Y= IPRED*(1+EPS(1))+EPS(2)

$SIM (1000) ONLYSIM NSUBPROBLEM=1

$TABLE ID TIME DV AMT AGE WT CL  FILE=mc_sim_1.tab NOAPPEND NOPRINT NOHEADER

;$EST METHOD=1 INTER MAXEVAL=9999 SIG=3 PRINT=5 NOABORT POSTHOC
